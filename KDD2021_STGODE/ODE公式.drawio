<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36 Edg/131.0.0.0" version="25.0.3">
  <diagram name="第 1 页" id="PVPRCsevbzZnFHXkMFGo">
    <mxGraphModel dx="2227" dy="792" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="Rd7MBk0ww_TVOZ5natJf-1" value="x（16，358，12，152）" style="text;strokeColor=none;align=center;fillColor=none;html=1;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="330" y="240" width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Rd7MBk0ww_TVOZ5natJf-2" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="399.71000000000004" y="270" as="sourcePoint" />
            <mxPoint x="400" y="310" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <UserObject label="torch.sigmoid(self.alpha).unsqueeze(-1).unsqueeze(-1).unsqueeze(0)" id="Rd7MBk0ww_TVOZ5natJf-3">
          <mxCell style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
            <mxGeometry x="414" y="270" width="400" height="40" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="Rd7MBk0ww_TVOZ5natJf-5" value="alpha（1，358，1，1）" style="text;strokeColor=none;align=center;fillColor=none;html=1;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="330" y="310" width="140" height="30" as="geometry" />
        </mxCell>
        <UserObject label="torch.einsum(&#39;ij, kjlm-&gt;kilm&#39;, self.adj, x)" id="Rd7MBk0ww_TVOZ5natJf-6">
          <mxCell style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
            <mxGeometry x="80" y="235" width="240" height="40" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="Rd7MBk0ww_TVOZ5natJf-7" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="199.71000000000004" y="270" as="sourcePoint" />
            <mxPoint x="200" y="310" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Rd7MBk0ww_TVOZ5natJf-10" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="300" y="420" as="sourcePoint" />
            <mxPoint x="300.28999999999996" y="460" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Rd7MBk0ww_TVOZ5natJf-11" value="xa（16，358，12，152）" style="text;strokeColor=none;align=center;fillColor=none;html=1;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="130" y="310" width="150" height="30" as="geometry" />
        </mxCell>
        <UserObject label="torch.clamp(self.d, min=0, max=1)" id="Rd7MBk0ww_TVOZ5natJf-12">
          <mxCell style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
            <mxGeometry x="-150" y="235" width="210" height="40" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="Rd7MBk0ww_TVOZ5natJf-13" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-60.289999999999964" y="260" as="sourcePoint" />
            <mxPoint x="-60" y="300" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Rd7MBk0ww_TVOZ5natJf-14" value="d（152）" style="text;strokeColor=none;align=center;fillColor=none;html=1;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-130" y="300" width="150" height="30" as="geometry" />
        </mxCell>
        <UserObject label="torch.mm(self.w * d, torch.t(self.w))" id="Rd7MBk0ww_TVOZ5natJf-15">
          <mxCell style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
            <mxGeometry x="-165" y="370" width="220" height="40" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="Rd7MBk0ww_TVOZ5natJf-16" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-60.289999999999964" y="330" as="sourcePoint" />
            <mxPoint x="-60" y="370" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Rd7MBk0ww_TVOZ5natJf-17" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-60.289999999999964" y="400" as="sourcePoint" />
            <mxPoint x="-60" y="440" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Rd7MBk0ww_TVOZ5natJf-18" value="w（152,152）" style="text;strokeColor=none;align=center;fillColor=none;html=1;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-130" y="440" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Rd7MBk0ww_TVOZ5natJf-19" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-60.289999999999964" y="470" as="sourcePoint" />
            <mxPoint x="-60" y="510" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <UserObject label="torch.einsum(&#39;ijkl, lm-&gt;ijkm&#39;, x, w)" id="Rd7MBk0ww_TVOZ5natJf-21">
          <mxCell style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
            <mxGeometry x="-50" y="470" width="210" height="40" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="Rd7MBk0ww_TVOZ5natJf-22" value="xw（16，358，12，152）" style="text;strokeColor=none;align=center;fillColor=none;html=1;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-125" y="510" width="155" height="30" as="geometry" />
        </mxCell>
        <UserObject label="torch.clamp(self.d2, min=0, max=1)" id="Rd7MBk0ww_TVOZ5natJf-23">
          <mxCell style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
            <mxGeometry x="-390" y="240" width="220" height="40" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="Rd7MBk0ww_TVOZ5natJf-24" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-290.28999999999996" y="260" as="sourcePoint" />
            <mxPoint x="-290" y="300" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Rd7MBk0ww_TVOZ5natJf-25" value="d2（12）" style="text;strokeColor=none;align=center;fillColor=none;html=1;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-360" y="300" width="150" height="30" as="geometry" />
        </mxCell>
        <UserObject label="torch.mm(self.w2 * d2, torch.t(self.w2))" id="Rd7MBk0ww_TVOZ5natJf-26">
          <mxCell style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
            <mxGeometry x="-540" y="330" width="240" height="40" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="Rd7MBk0ww_TVOZ5natJf-27" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-290.28999999999996" y="330" as="sourcePoint" />
            <mxPoint x="-290" y="370" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Rd7MBk0ww_TVOZ5natJf-28" value="w2（12,12）" style="text;strokeColor=none;align=center;fillColor=none;html=1;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-360" y="370" width="150" height="30" as="geometry" />
        </mxCell>
        <UserObject label="torch.einsum(&#39;ijkl, km-&gt;ijml&#39;, x, w2)" id="Rd7MBk0ww_TVOZ5natJf-29">
          <mxCell style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
            <mxGeometry x="-500" y="400" width="220" height="40" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="Rd7MBk0ww_TVOZ5natJf-30" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-290.28999999999996" y="400" as="sourcePoint" />
            <mxPoint x="-290" y="440" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Rd7MBk0ww_TVOZ5natJf-32" value="xw2（16，358，12，152）" style="text;strokeColor=none;align=center;fillColor=none;html=1;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-375" y="450" width="165" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Rd7MBk0ww_TVOZ5natJf-34" value="alpha / 2 * xa - x + xw - x + xw2 - x + self.x0" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="190" y="400" width="270" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Rd7MBk0ww_TVOZ5natJf-35" value="f（16，358，12，152）" style="text;strokeColor=none;align=center;fillColor=none;html=1;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="220" y="460" width="150" height="30" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
